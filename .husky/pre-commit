#!/bin/sh
set -e

cd client && npm run lint && npm run format && cd ..
cd server && npm run lint && npm run format && cd ..

if git diff --name-only --cached | grep -E "package\.json$" >/dev/null; then
	echo "Running security audit..."
	(cd server && npm run audit)
else
	echo "No package.json changes detected; skipping audit."
fi
